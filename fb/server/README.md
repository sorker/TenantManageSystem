# ç§Ÿæˆ·ç®¡ç†ç³»ç»Ÿ - æœåŠ¡ç«¯

åŸºäº Node.js + Express + SQLite çš„ç§Ÿæˆ·ç®¡ç†ç³»ç»Ÿåç«¯é¡¹ç›®ã€‚

## æŠ€æœ¯æ ˆ

- ğŸ”§ Node.js - è¿è¡Œç¯å¢ƒ
- ğŸš€ Express - Web æ¡†æ¶
- ğŸ’¾ SQLite - æ•°æ®åº“
- ğŸ” JWT - èº«ä»½è®¤è¯
- ğŸ“ Joi - æ•°æ®éªŒè¯
- ğŸ§ª Jest - å•å…ƒæµ‹è¯•

## å¼€å‘ç¯å¢ƒè¦æ±‚

- Node.js >= 18.20.3
- npm >= 10.7.0

## é¡¹ç›®ç»“æ„

```
server/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ config/         # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ controllers/    # æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ models/         # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ routes/         # è·¯ç”±å®šä¹‰
â”‚   â”œâ”€â”€ middlewares/    # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ utils/          # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ validators/     # æ•°æ®éªŒè¯
â”‚   â””â”€â”€ app.js          # åº”ç”¨å…¥å£
â”œâ”€â”€ tests/              # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ database/           # æ•°æ®åº“æ–‡ä»¶
â””â”€â”€ package.json        # é¡¹ç›®ä¾èµ–
```

## API æ¥å£

### ç§Ÿæˆ·ç®¡ç†

1. ç§Ÿæˆ·ä¿¡æ¯
   - GET /api/tenants - è·å–ç§Ÿæˆ·åˆ—è¡¨
   - POST /api/tenants - åˆ›å»ºç§Ÿæˆ·
   - GET /api/tenants/:id - è·å–ç§Ÿæˆ·è¯¦æƒ…
   - PUT /api/tenants/:id - æ›´æ–°ç§Ÿæˆ·ä¿¡æ¯
   - DELETE /api/tenants/:id - åˆ é™¤ç§Ÿæˆ·

2. ç§Ÿçº¦ç®¡ç†
   - GET /api/contracts - è·å–ç§Ÿçº¦åˆ—è¡¨
   - POST /api/contracts - åˆ›å»ºç§Ÿçº¦
   - GET /api/contracts/:id - è·å–ç§Ÿçº¦è¯¦æƒ…
   - PUT /api/contracts/:id - æ›´æ–°ç§Ÿçº¦
   - DELETE /api/contracts/:id - åˆ é™¤ç§Ÿçº¦

### æˆ¿é—´ç®¡ç†

1. æˆ¿é—´ä¿¡æ¯
   - GET /api/rooms - è·å–æˆ¿é—´åˆ—è¡¨
   - POST /api/rooms - åˆ›å»ºæˆ¿é—´
   - GET /api/rooms/:id - è·å–æˆ¿é—´è¯¦æƒ…
   - PUT /api/rooms/:id - æ›´æ–°æˆ¿é—´ä¿¡æ¯
   - DELETE /api/rooms/:id - åˆ é™¤æˆ¿é—´

2. æˆ¿é—´çŠ¶æ€
   - PUT /api/rooms/:id/status - æ›´æ–°æˆ¿é—´çŠ¶æ€
   - GET /api/rooms/status - è·å–æˆ¿é—´çŠ¶æ€ç»Ÿè®¡

### ä½ç½®ç®¡ç†

1. ä½ç½®ä¿¡æ¯
   - GET /api/locations - è·å–ä½ç½®åˆ—è¡¨
   - POST /api/locations - åˆ›å»ºä½ç½®
   - GET /api/locations/:id - è·å–ä½ç½®è¯¦æƒ…
   - PUT /api/locations/:id - æ›´æ–°ä½ç½®ä¿¡æ¯
   - DELETE /api/locations/:id - åˆ é™¤ä½ç½®

2. ä½ç½®ç»Ÿè®¡
   - GET /api/locations/:id/stats - è·å–ä½ç½®ç»Ÿè®¡ä¿¡æ¯
   - GET /api/locations/stats - è·å–æ‰€æœ‰ä½ç½®ç»Ÿè®¡

### è®¾æ–½ç®¡ç†

1. è®¾æ–½ä¿¡æ¯
   - GET /api/facilities - è·å–è®¾æ–½åˆ—è¡¨
   - POST /api/facilities - åˆ›å»ºè®¾æ–½
   - GET /api/facilities/:id - è·å–è®¾æ–½è¯¦æƒ…
   - PUT /api/facilities/:id - æ›´æ–°è®¾æ–½ä¿¡æ¯
   - DELETE /api/facilities/:id - åˆ é™¤è®¾æ–½

2. è®¾æ–½å…³è”
   - POST /api/rooms/:id/facilities - æ·»åŠ æˆ¿é—´è®¾æ–½
   - DELETE /api/rooms/:id/facilities/:facilityId - ç§»é™¤æˆ¿é—´è®¾æ–½

### æ”¯ä»˜ç®¡ç†

1. æ”¯ä»˜è®°å½•
   - GET /api/payments - è·å–æ”¯ä»˜è®°å½•
   - POST /api/payments - åˆ›å»ºæ”¯ä»˜è®°å½•
   - GET /api/payments/:id - è·å–æ”¯ä»˜è¯¦æƒ…
   - PUT /api/payments/:id - æ›´æ–°æ”¯ä»˜è®°å½•
   - DELETE /api/payments/:id - åˆ é™¤æ”¯ä»˜è®°å½•

2. æ”¯ä»˜ç»Ÿè®¡
   - GET /api/payments/stats - è·å–æ”¯ä»˜ç»Ÿè®¡
   - GET /api/payments/tenant/:id - è·å–ç§Ÿæˆ·æ”¯ä»˜è®°å½•

## å¼€å‘æŒ‡å—

1. å®‰è£…ä¾èµ–ï¼š
```bash
npm install
```

2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š
```bash
npm run dev
```

3. æ„å»ºç”Ÿäº§ç‰ˆæœ¬ï¼š
```bash
npm run build
```

4. è¿è¡Œæµ‹è¯•ï¼š
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm run test

# è¿è¡Œå•å…ƒæµ‹è¯•
npm run test:unit

# è¿è¡Œé›†æˆæµ‹è¯•
npm run test:integration

# æŸ¥çœ‹æµ‹è¯•è¦†ç›–ç‡
npm run test:coverage
```

## æ•°æ®åº“è®¾è®¡

### ä¸»è¦è¡¨ç»“æ„

1. tenantsï¼ˆç§Ÿæˆ·è¡¨ï¼‰
   - id: ä¸»é”®
   - name: å§“å
   - phone: ç”µè¯
   - status: çŠ¶æ€
   - created_at: åˆ›å»ºæ—¶é—´
   - updated_at: æ›´æ–°æ—¶é—´

2. roomsï¼ˆæˆ¿é—´è¡¨ï¼‰
   - id: ä¸»é”®
   - room_number: æˆ¿é—´å·
   - location_id: ä½ç½®ID
   - status: çŠ¶æ€
   - area: é¢ç§¯
   - price: ä»·æ ¼
   - created_at: åˆ›å»ºæ—¶é—´
   - updated_at: æ›´æ–°æ—¶é—´

3. facilitiesï¼ˆè®¾æ–½è¡¨ï¼‰
   - id: ä¸»é”®
   - name: åç§°
   - type: ç±»å‹
   - status: çŠ¶æ€
   - created_at: åˆ›å»ºæ—¶é—´
   - updated_at: æ›´æ–°æ—¶é—´

4. paymentsï¼ˆæ”¯ä»˜è¡¨ï¼‰
   - id: ä¸»é”®
   - tenant_id: ç§Ÿæˆ·ID
   - amount: é‡‘é¢
   - type: ç±»å‹
   - payment_date: æ”¯ä»˜æ—¥æœŸ
   - created_at: åˆ›å»ºæ—¶é—´
   - updated_at: æ›´æ–°æ—¶é—´

## å®‰å…¨æªæ–½

1. èº«ä»½è®¤è¯
   - JWT token è®¤è¯
   - å¯†ç åŠ å¯†å­˜å‚¨
   - ä¼šè¯ç®¡ç†

2. æ•°æ®å®‰å…¨
   - è¾“å…¥éªŒè¯
   - SQL æ³¨å…¥é˜²æŠ¤
   - XSS é˜²æŠ¤

3. è®¿é—®æ§åˆ¶
   - è§’è‰²æƒé™ç®¡ç†
   - API è®¿é—®é™åˆ¶
   - æ•æ„Ÿæ“ä½œæ—¥å¿—

## æ€§èƒ½ä¼˜åŒ–

1. æ•°æ®åº“ä¼˜åŒ–
   - ç´¢å¼•ä¼˜åŒ–
   - æŸ¥è¯¢ä¼˜åŒ–
   - è¿æ¥æ± ç®¡ç†

2. ç¼“å­˜ç­–ç•¥
   - æ•°æ®ç¼“å­˜
   - æŸ¥è¯¢ç¼“å­˜
   - é™æ€èµ„æºç¼“å­˜

3. å¹¶å‘å¤„ç†
   - å¼‚æ­¥å¤„ç†
   - é˜Ÿåˆ—ç®¡ç†
   - è´Ÿè½½å‡è¡¡

## éƒ¨ç½²

1. ç¯å¢ƒè¦æ±‚
   - Node.js ç¯å¢ƒ
   - SQLite æ•°æ®åº“
   - PM2 è¿›ç¨‹ç®¡ç†

2. éƒ¨ç½²æ­¥éª¤
   - å®‰è£…ä¾èµ–
   - é…ç½®ç¯å¢ƒå˜é‡
   - å¯åŠ¨æœåŠ¡

3. ç›‘æ§ç»´æŠ¤
   - æ—¥å¿—ç®¡ç†
   - æ€§èƒ½ç›‘æ§
   - é”™è¯¯è¿½è¸ª

## æ³¨æ„äº‹é¡¹

1. å¼€å‘è§„èŒƒ
   - éµå¾ª RESTful API è®¾è®¡è§„èŒƒ
   - ä½¿ç”¨ TypeScript ç±»å‹æ³¨è§£
   - ä¿æŒä»£ç é£æ ¼ä¸€è‡´

2. å®‰å…¨è€ƒè™‘
   - å®šæœŸæ›´æ–°ä¾èµ–
   - æ•°æ®å¤‡ä»½
   - é”™è¯¯å¤„ç†

3. æ€§èƒ½è€ƒè™‘
   - é¿å… N+1 æŸ¥è¯¢
   - åˆç†ä½¿ç”¨ç¼“å­˜
   - ä¼˜åŒ–æ•°æ®åº“æ“ä½œ

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»º Pull Request

## è®¸å¯è¯

MIT License 